// ==UserScript==
// @name         YouTube Thumbnail Hover Shift
// @match        https://www.youtube.com/*
// @run-at       document-end
// ==/UserScript==

(function() {
  'use strict';

  function setupHoverShift() {
    const videos = document.querySelectorAll('ytd-compact-video-renderer');
    console.log(`[HoverShift] Found ${videos.length} videos`);

    videos.forEach(video => {
      const thumbnail = video.querySelector('#thumbnail');
      const container = video.querySelector('#container');
      const title = video.querySelector('#video-title');
      const metadata = video.querySelector('#metadata-line');
      const byline = video.querySelector('#byline-container');
      const iconDiv = video.querySelector('.ytd-menu-renderer.style-scope > .yt-spec-icon-shape.yt-icon.style-scope.yt-icon-shape > div');

      if (!thumbnail || !container || !title || !metadata || !byline || !iconDiv) {
        console.log('[HoverShift] Missing elements:', {thumbnail, container, title, metadata, byline, iconDiv});
        return;
      }

      container.style.position = 'relative';

      thumbnail.style.left = '250px';
      thumbnail.style.opacity = '0';
      thumbnail.style.pointerEvents = 'none';

      title.style.left = '0';
      title.style.width = '120px';

      metadata.style.left = '0';
      byline.style.left = '0';
      iconDiv.style.left = '0';

      title.onmouseenter = null;
      title.onmouseleave = null;

      title.addEventListener('mouseenter', () => {
        thumbnail.style.left = '130px';
        thumbnail.style.opacity = '1';
        thumbnail.style.pointerEvents = 'auto';

        title.style.left = '130px';
        title.style.width = 'calc(100% - 130px)';

        metadata.style.left = '130px';
        byline.style.left = '130px';
        iconDiv.style.left = '130px';
      });

      title.addEventListener('mouseleave', () => {
        thumbnail.style.left = '250px';
        thumbnail.style.opacity = '0';
        thumbnail.style.pointerEvents = 'none';

        title.style.left = '0';
        title.style.width = '120px';

        metadata.style.left = '0';
        byline.style.left = '0';
        iconDiv.style.left = '0';
      });
    });
  }

  window.addEventListener('load', setupHoverShift);
  window.addEventListener('yt-navigate-finish', setupHoverShift);
})();
